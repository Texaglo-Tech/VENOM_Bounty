{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Mutex = exports.Semaphore = void 0;\nfunction ensureCallable(fn) {\n  if (typeof fn !== 'function') throw new TypeError(fn + \" is not a function\");\n  return fn;\n}\nfunction byObserver(Observer) {\n  const node = document.createTextNode('');\n  let queue,\n    currentQueue,\n    bit = 0,\n    i = 0;\n  new Observer(function () {\n    let callback;\n    if (!queue) {\n      if (!currentQueue) return;\n      queue = currentQueue;\n    } else if (currentQueue) {\n      queue = currentQueue.slice(i).concat(queue);\n    }\n    currentQueue = queue;\n    queue = null;\n    i = 0;\n    if (typeof currentQueue === 'function') {\n      callback = currentQueue;\n      currentQueue = null;\n      callback();\n      return;\n    }\n    node.data = bit = ++bit % 2; // Invoke other batch, to handle leftover callbacks in case of crash\n    while (i < currentQueue.length) {\n      callback = currentQueue[i];\n      i++;\n      if (i === currentQueue.length) currentQueue = null;\n      callback();\n    }\n  }).observe(node, {\n    characterData: true\n  });\n  return function (fn) {\n    ensureCallable(fn);\n    if (queue) {\n      if (typeof queue === 'function') queue = [queue, fn];else queue.push(fn);\n      return;\n    }\n    queue = fn;\n    node.data = bit = ++bit % 2;\n  };\n}\nconst nextTick = function () {\n  // queueMicrotask\n  if (typeof queueMicrotask === \"function\") {\n    return function (cb) {\n      queueMicrotask(ensureCallable(cb));\n    };\n  }\n  // MutationObserver\n  if (typeof document === 'object' && document) {\n    if (typeof MutationObserver === 'function') return byObserver(MutationObserver);\n    if (typeof window.WebKitMutationObserver === 'function') return byObserver(window.WebKitMutationObserver);\n  }\n  // W3C Draft\n  // http://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html\n  if (typeof setImmediate === 'function') {\n    return function (cb) {\n      setImmediate(ensureCallable(cb));\n    };\n  }\n  // Wide available standard\n  if (typeof setTimeout === 'function' || typeof setTimeout === 'object') {\n    return function (cb) {\n      setTimeout(ensureCallable(cb), 0);\n    };\n  }\n  throw new Error('No `nextTick` implementation found');\n}();\nclass Semaphore {\n  constructor(count) {\n    this.tasks = [];\n    this.count = count;\n  }\n  sched() {\n    if (this.count > 0 && this.tasks.length > 0) {\n      this.count--;\n      let next = this.tasks.shift();\n      if (next === undefined) {\n        throw \"Unexpected undefined value in tasks list\";\n      }\n      next();\n    }\n  }\n  acquire() {\n    return new Promise((res, _rej) => {\n      const task = () => {\n        let released = false;\n        res(() => {\n          if (!released) {\n            released = true;\n            this.count++;\n            this.sched();\n          }\n        });\n      };\n      this.tasks.push(task);\n      nextTick(this.sched.bind(this));\n    });\n  }\n  use(f) {\n    return this.acquire().then(release => {\n      return f().then(res => {\n        release();\n        return res;\n      }).catch(err => {\n        release();\n        throw err;\n      });\n    });\n  }\n}\nexports.Semaphore = Semaphore;\nclass Mutex extends Semaphore {\n  constructor() {\n    super(1);\n  }\n}\nexports.Mutex = Mutex;","map":{"version":3,"names":["Object","defineProperty","exports","value","Mutex","Semaphore","ensureCallable","fn","TypeError","byObserver","Observer","node","document","createTextNode","queue","currentQueue","bit","i","callback","slice","concat","data","length","observe","characterData","push","nextTick","queueMicrotask","cb","MutationObserver","window","WebKitMutationObserver","setImmediate","setTimeout","Error","constructor","count","tasks","sched","next","shift","undefined","acquire","Promise","res","_rej","task","released","bind","use","f","then","release","catch","err"],"sources":["/home/king/Desktop/venom-connect-main/examples/react/node_modules/@broxus/await-semaphore/dist/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Mutex = exports.Semaphore = void 0;\nfunction ensureCallable(fn) {\n    if (typeof fn !== 'function')\n        throw new TypeError(fn + \" is not a function\");\n    return fn;\n}\nfunction byObserver(Observer) {\n    const node = document.createTextNode('');\n    let queue, currentQueue, bit = 0, i = 0;\n    new Observer(function () {\n        let callback;\n        if (!queue) {\n            if (!currentQueue)\n                return;\n            queue = currentQueue;\n        }\n        else if (currentQueue) {\n            queue = currentQueue.slice(i).concat(queue);\n        }\n        currentQueue = queue;\n        queue = null;\n        i = 0;\n        if (typeof currentQueue === 'function') {\n            callback = currentQueue;\n            currentQueue = null;\n            callback();\n            return;\n        }\n        node.data = (bit = ++bit % 2); // Invoke other batch, to handle leftover callbacks in case of crash\n        while (i < currentQueue.length) {\n            callback = currentQueue[i];\n            i++;\n            if (i === currentQueue.length)\n                currentQueue = null;\n            callback();\n        }\n    }).observe(node, { characterData: true });\n    return function (fn) {\n        ensureCallable(fn);\n        if (queue) {\n            if (typeof queue === 'function')\n                queue = [queue, fn];\n            else\n                queue.push(fn);\n            return;\n        }\n        queue = fn;\n        node.data = (bit = ++bit % 2);\n    };\n}\nconst nextTick = (function () {\n    // queueMicrotask\n    if (typeof queueMicrotask === \"function\") {\n        return function (cb) {\n            queueMicrotask(ensureCallable(cb));\n        };\n    }\n    // MutationObserver\n    if ((typeof document === 'object') && document) {\n        if (typeof MutationObserver === 'function')\n            return byObserver(MutationObserver);\n        if (typeof window.WebKitMutationObserver === 'function')\n            return byObserver(window.WebKitMutationObserver);\n    }\n    // W3C Draft\n    // http://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html\n    if (typeof setImmediate === 'function') {\n        return function (cb) {\n            setImmediate(ensureCallable(cb));\n        };\n    }\n    // Wide available standard\n    if ((typeof setTimeout === 'function') || (typeof setTimeout === 'object')) {\n        return function (cb) {\n            setTimeout(ensureCallable(cb), 0);\n        };\n    }\n    throw new Error('No `nextTick` implementation found');\n}());\nclass Semaphore {\n    constructor(count) {\n        this.tasks = [];\n        this.count = count;\n    }\n    sched() {\n        if (this.count > 0 && this.tasks.length > 0) {\n            this.count--;\n            let next = this.tasks.shift();\n            if (next === undefined) {\n                throw \"Unexpected undefined value in tasks list\";\n            }\n            next();\n        }\n    }\n    acquire() {\n        return new Promise((res, _rej) => {\n            const task = () => {\n                let released = false;\n                res(() => {\n                    if (!released) {\n                        released = true;\n                        this.count++;\n                        this.sched();\n                    }\n                });\n            };\n            this.tasks.push(task);\n            nextTick(this.sched.bind(this));\n        });\n    }\n    use(f) {\n        return this.acquire()\n            .then(release => {\n            return f()\n                .then((res) => {\n                release();\n                return res;\n            })\n                .catch((err) => {\n                release();\n                throw err;\n            });\n        });\n    }\n}\nexports.Semaphore = Semaphore;\nclass Mutex extends Semaphore {\n    constructor() {\n        super(1);\n    }\n}\nexports.Mutex = Mutex;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}